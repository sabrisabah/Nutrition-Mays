# إصلاح عرض نوع الخطة الغذائية للمريض

## المشكلة
عند اختيار نوع الخطة الغذائية من قبل الطبيب، لا يظهر نوع النظام الغذائي بشكل صحيح في واجهة المريض.

## التشخيص
1. **فحص نموذج البيانات**: تم التأكد من وجود حقل `diet_plan` في نموذج `MealPlan`
2. **فحص Serializer**: وجد أن `MealPlanSerializer` لا يتضمن ترجمة نوع النظام الغذائي
3. **فحص الواجهة**: الواجهة الأمامية تعتمد على ترجمة محلية بدلاً من البيانات من الخادم

## الحل المطبق

### 1. تحديث MealPlanSerializer
تم إضافة حقل `diet_plan_display` مع دالة ترجمة شاملة:

```python
class MealPlanSerializer(serializers.ModelSerializer):
    # ... الحقول الموجودة
    diet_plan_display = serializers.SerializerMethodField()
    
    def get_diet_plan_display(self, obj):
        """ترجمة نوع النظام الغذائي للعربية"""
        diet_translations = {
            'keto': 'الكيتو',
            'balanced': 'المتوازن',
            'high_protein': 'عالي البروتين',
            'low_carb': 'منخفض الكربوهيدرات',
            'mediterranean': 'البحر الأبيض المتوسط',
            'vegetarian': 'نباتي',
            'vegan': 'نباتي صرف',
            'paleo': 'الباليو',
            'weight_loss': 'إنقاص وزن',
            'weight_gain': 'زيادة وزن',
            'muscle_building': 'بناء العضلات',
            'diabetic': 'مرضى السكري',
            'heart_healthy': 'صحة القلب',
            'intermittent_fasting': 'الصيام المتقطع'
        }
        return diet_translations.get(obj.diet_plan, obj.diet_plan or 'غير محدد')
```

### 2. تحديث واجهة المريض
تم تحديث الملفات التالية لاستخدام `diet_plan_display`:

#### في `src/pages/patient/MealPlans.jsx`:
- تحديث عرض نوع النظام الغذائي في header الخطة
- تحديث عرض نوع النظام الغذائي في modal التفاصيل
- تحديث النص التوضيحي للوجبات المقترحة

#### في `src/pages/patient/Dashboard.jsx`:
- تحديث عرض نوع النظام الغذائي في بطاقات الخطط

### 3. التحسينات المضافة
- **ترجمة شاملة**: تغطية جميع أنواع الأنظمة الغذائية الشائعة
- **Fallback آمن**: في حالة عدم وجود ترجمة، يعرض النص الأصلي
- **اتساق في العرض**: استخدام نفس الترجمة في جميع أنحاء التطبيق

## النتيجة المتوقعة
بعد تطبيق هذا الإصلاح:

1. ✅ **عرض صحيح لنوع النظام الغذائي** في جميع صفحات المريض
2. ✅ **ترجمة عربية دقيقة** لجميع أنواع الأنظمة الغذائية
3. ✅ **اتساق في العرض** بين صفحة Dashboard وصفحة خطط الوجبات
4. ✅ **معلومات واضحة للمريض** حول نوع النظام الغذائي المخصص له

## الملفات المحدثة
- `meal_plans/serializers.py` - إضافة `diet_plan_display`
- `src/pages/patient/MealPlans.jsx` - استخدام `diet_plan_display`
- `src/pages/patient/Dashboard.jsx` - استخدام `diet_plan_display`

## اختبار الإصلاح
1. قم بإنشاء خطة وجبات جديدة من واجهة الطبيب
2. اختر نوع نظام غذائي محدد (مثل "الكيتو" أو "عالي البروتين")
3. تحقق من ظهور نوع النظام الغذائي بشكل صحيح في واجهة المريض
4. تأكد من الترجمة العربية الصحيحة

## ملاحظات إضافية
- الترجمة تتم في الخادم (Backend) مما يضمن الاتساق
- يمكن إضافة ترجمات جديدة بسهولة في `diet_translations`
- النظام يدعم Fallback للنصوص غير المترجمة
