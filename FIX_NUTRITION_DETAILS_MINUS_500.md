# إصلاح تفاصيل القيم الغذائية لتعرض السعرات المحسوبة - 500

## المطلوب
تعديل قسم "تفاصيل القيم الغذائية" ليعرض السعرات الحرارية مع طرح 500 سعرة حرارية كما هو موضح في الصورة.

## التحديثات المطبقة

### 1. السعرات الحرارية في تفاصيل القيم الغذائية
**قبل التعديل**:
```
السعرات الحرارية: 2438 سعرة
```

**بعد التعديل**:
```
السعرات الحرارية: 1938 سعرة (2438 - 500)
```

### 2. شريط التقدم للسعرات الحرارية
**قبل التعديل**: محسوب بناءً على 2438 سعرة حرارية
**بعد التعديل**: محسوب بناءً على 1938 سعرة حرارية (2438 - 500)

### 3. النسب المئوية للمغذيات الكبرى
**قبل التعديل**:
```
البروتين: 207 جرام (34.0% من السعرات)
الكربوهيدرات: 250 جرام (41.0% من السعرات)
الدهون: 68 جرام (25.1% من السعرات)
```

**بعد التعديل**:
```
البروتين: 207 جرام (42.7% من السعرات) - محسوب بناءً على 1938
الكربوهيدرات: 250 جرام (51.6% من السعرات) - محسوب بناءً على 1938
الدهون: 68 جرام (31.6% من السعرات) - محسوب بناءً على 1938
```

## الأقسام التي تم تعديلها

### 1. عرض السعرات الحرارية
- **الموقع**: قسم "تفاصيل القيم الغذائية"
- **التعديل**: `patientNutritionData.targetCalories - 500`

### 2. شريط التقدم
- **الموقع**: شريط التقدم للسعرات الحرارية
- **التعديل**: `getProgressBarWidth(patientNutritionData.targetCalories - 500, displayNutrition.target_calories)`

### 3. حساب النسب المئوية للبروتين
- **الموقع**: قسم البروتين
- **التعديل**: `((displayNutrition.total_protein * 4) / (patientNutritionData.targetCalories - 500) * 100)`

### 4. حساب النسب المئوية للكربوهيدرات
- **الموقع**: قسم الكربوهيدرات
- **التعديل**: `((displayNutrition.total_carbs * 4) / (patientNutritionData.targetCalories - 500) * 100)`

### 5. حساب النسب المئوية للدهون
- **الموقع**: قسم الدهون
- **التعديل**: `((displayNutrition.total_fat * 9) / (patientNutritionData.targetCalories - 500) * 100)`

## الملفات المعدلة

1. `src/components/DailyMealPlanner.jsx` - تعديل قسم "تفاصيل القيم الغذائية"

## النتيجة النهائية

الآن قسم "تفاصيل القيم الغذائية" يعرض:
- **السعرات الحرارية**: 1938 سعرة حرارية (2438 - 500)
- **شريط التقدم**: محسوب بناءً على 1938 سعرة حرارية
- **النسب المئوية**: محسوبة بناءً على 1938 سعرة حرارية

## مثال على النتيجة

إذا كانت السعرات المحسوبة 2438:
- **السعرات الحرارية**: 1938 سعرة حرارية
- **البروتين**: 207 جرام (42.7% من السعرات)
- **الكربوهيدرات**: 250 جرام (51.6% من السعرات)
- **الدهون**: 68 جرام (31.6% من السعرات)

## الاختبار

لاختبار التحديث:
1. انتقل إلى مخطط الوجبات اليومية
2. اختر مريضاً وحدد قالب وجبة
3. انتقل إلى قسم "تفاصيل القيم الغذائية"
4. تأكد من ظهور 1938 سعرة حرارية
5. تأكد من صحة النسب المئوية

الآن قسم "تفاصيل القيم الغذائية" يعرض السعرات المحسوبة مع طرح 500 سعرة حرارية كما هو مطلوب!
