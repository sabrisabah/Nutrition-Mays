import React, { useState, useEffect } from 'react'

const DietPlansSystem = ({ patientProfile, nutritionData, onDietPlanSelected }) => {
  const [selectedDietPlan, setSelectedDietPlan] = useState(null)
  const [customizedPlan, setCustomizedPlan] = useState(null)
  const [isLoading, setIsLoading] = useState(false)
  const [showFullDetails, setShowFullDetails] = useState(false)
  const [selectedCalories, setSelectedCalories] = useState(null) // ุญูุธ ุงูุณุนุฑุงุช ุงููุฎุชุงุฑุฉ

  // ุชุนุฑูู ุงูุฃูุธูุฉ ุงูุบุฐุงุฆูุฉ ุงููุชูุงููุฉ
  const dietPlans = {
    keto: {
      id: 'keto',
      name: 'ูุธุงู ุงูููุชู ุฏุงูุช',
      description: 'ูุธุงู ุบุฐุงุฆู ุนุงูู ุงูุฏููู ูููุฎูุถ ุงููุฑุจูููุฏุฑุงุช ูุญุฑู ุงูุฏููู (ูุชู ุชุฎููุถ 500 ุณุนุฑุฉ ุญุฑุงุฑูุฉ)',
      icon: '๐ฅ',
      color: 'success',
      macroDistribution: {
        carbs: 5,    // 5% ูู ุงูุณุนุฑุงุช
        protein: 20, // 20% ูู ุงูุณุนุฑุงุช
        fat: 75      // 75% ูู ุงูุณุนุฑุงุช
      },
      dailyMeals: {
        breakfast: [
          'ุจูุถ ูููู ุจุงูุฒุจุฏุฉ (2 ุจูุถุฉ)',
          'ุฃูููุงุฏู (ูุตู ุญุจุฉ)',
          'ูุญู ุจูุฑู (2 ุดุฑูุญุฉ)',
          'ูููุฉ ุจุงูุฒุจุฏุฉ'
        ],
        lunch: [
          'ุณูุทุฉ ุฎุถุฑุงุก ูุน ุฒูุช ุงูุฒูุชูู',
          'ุณูู ุณูููู ูุดูู (150 ุฌู)',
          'ุจุฑูููู ูุทูู ุจุงูุฒุจุฏุฉ',
          'ุฌุจูุฉ ุดูุฏุฑ (30 ุฌู)'
        ],
        dinner: [
          'ูุญู ุจูุฑู ูุดูู (200 ุฌู)',
          'ูุฑู ุณุจุงูุฎ',
          'ูุทุฑ ูุดูู',
          'ุฒูุชูู ุฃุณูุฏ'
        ],
        snacks: [
          'ุฌูุฒ (15 ุญุจุฉ)',
          'ุฌุจูุฉ ูุงููุฉ ุงูุฏุณู (30 ุฌู)',
          'ุฒูุชูู (10 ุญุจุงุช)'
        ]
      },
      allowedFoods: [
        'ุงููุญูู ุงูุญูุฑุงุก ูุงูุฏูุงุฌู',
        'ุงูุฃุณูุงู ุงูุฏูููุฉ',
        'ุงูุจูุถ',
        'ุงูุฃูููุงุฏู',
        'ุงูููุณุฑุงุช ูุงูุจุฐูุฑ',
        'ุงูุฒููุช ุงูุตุญูุฉ',
        'ุงูุฎุถุฑูุงุช ุงููุฑููุฉ',
        'ุงูุฌุจูุฉ ูุงููุฉ ุงูุฏุณู'
      ],
      restrictedFoods: [
        'ุงูุญุจูุจ ูุงููุดููุงุช',
        'ุงูููุงูู ุนุงููุฉ ุงูุณูุฑ',
        'ุงูุจููููุงุช',
        'ุงูุณูุฑูุงุช ูุงูุญูููุงุช',
        'ุงููุดุฑูุจุงุช ุงููุญูุงุฉ'
      ],
      benefits: [
        'ููุฏุงู ุณุฑูุน ูููุฒู',
        'ุชุญุณูู ุญุณุงุณูุฉ ุงูุฃูุณูููู',
        'ุฒูุงุฏุฉ ุงูุทุงูุฉ ูุงูุชุฑููุฒ',
        'ุชูููู ุงูุงูุชูุงุจุงุช'
      ],
      considerations: [
        'ูุญุชุงุฌ ูุชุฑุฉ ุชููู 2-4 ุฃุณุงุจูุน',
        'ูุฏ ูุณุจุจ ุฅูุณุงู ูู ุงูุจุฏุงูุฉ',
        'ูุญุชุงุฌ ุดุฑุจ ูุงุก ุฃูุซุฑ',
        'ูููุตุญ ุจูุฑุงูุจุฉ ุงูููุชููุงุช'
      ]
    },
    balanced: {
      id: 'balanced',
      name: 'ุงููุธุงู ุงููุชูุงุฒู',
      description: 'ูุธุงู ุบุฐุงุฆู ูุชูุงุฒู ูุญุชูู ุนูู ุฌููุน ุงูุนูุงุตุฑ ุงูุบุฐุงุฆูุฉ (ูุชู ุชุฎููุถ 500 ุณุนุฑุฉ ุญุฑุงุฑูุฉ)',
      icon: 'โ๏ธ',
      color: 'primary',
      macroDistribution: {
        carbs: 50,   // 50% ูู ุงูุณุนุฑุงุช
        protein: 25, // 25% ูู ุงูุณุนุฑุงุช
        fat: 25      // 25% ูู ุงูุณุนุฑุงุช
      },
      dailyMeals: {
        breakfast: [
          'ุดููุงู ูุน ุงูุญููุจ (ููุจ)',
          'ููุฒ (ุญุจุฉ ูุชูุณุทุฉ)',
          'ุฌูุฒ (10 ุญุจุงุช)',
          'ุนุณู (ููุนูุฉ ุตุบูุฑุฉ)'
        ],
        lunch: [
          'ุฃุฑุฒ ุจูู (ููุจ)',
          'ุฏุฌุงุฌ ูุดูู (150 ุฌู)',
          'ุฎุถุฑูุงุช ูุดููุฉ',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        dinner: [
          'ุณูู ูุดูู (150 ุฌู)',
          'ุจุทุงุทุง ุญููุฉ ูุดููุฉ',
          'ุจุฑูููู ูุทูู',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        snacks: [
          'ุชูุงุญ (ุญุจุฉ)',
          'ุฒุจุฏุฉ ุงูููู ุงูุณูุฏุงูู (ููุนูุฉ)',
          'ุฌุจูุฉ ููููุฉ ุงูุฏุณู (30 ุฌู)'
        ]
      },
      allowedFoods: [
        'ุฌููุน ุฃููุงุน ุงูุญุจูุจ ุงููุงููุฉ',
        'ุงูููุงูู ูุงูุฎุถุฑูุงุช',
        'ุงูุจุฑูุชููุงุช ุงูุฎุงููุฉ ูู ุงูุฏููู',
        'ุงูุฏููู ุงูุตุญูุฉ',
        'ููุชุฌุงุช ุงูุฃูุจุงู ููููุฉ ุงูุฏุณู',
        'ุงูููุณุฑุงุช ูุงูุจุฐูุฑ'
      ],
      restrictedFoods: [
        'ุงูุฃุทุนูุฉ ุงููุตูุนุฉ',
        'ุงูุณูุฑูุงุช ุงููุถุงูุฉ',
        'ุงูุฏููู ุงููุชุญููุฉ',
        'ุงููุดุฑูุจุงุช ุงููุญูุงุฉ'
      ],
      benefits: [
        'ุชูุงุฒู ุบุฐุงุฆู ูุซุงูู',
        'ุณูู ุงููุชุงุจุนุฉ',
        'ููุงุณุจ ูุฌููุน ุงูุฃุนูุงุฑ',
        'ูุฏุนู ุงูุตุญุฉ ุงูุนุงูุฉ'
      ],
      considerations: [
        'ูุญุชุงุฌ ุชุฎุทูุท ูุฌุจุงุช',
        'ูุฑููุฉ ูู ุงูุงุฎุชูุงุฑุงุช',
        'ููุงุณุจ ููุฑูุงุถููู',
        'ูุฏุนู ููุฏุงู ุงููุฒู ุงูุชุฏุฑูุฌู'
      ]
    },
    integrated: {
      id: 'integrated',
      name: 'ุงููุธุงู ุงูุบุฐุงุฆู ุงููุชูุงูู',
      description: 'ูุธุงู ุบุฐุงุฆู ูุชูุงูู ูุดุงูู ูุญุชูู ุนูู ุฌููุน ุงูุนูุงุตุฑ ุงูุบุฐุงุฆูุฉ (ูุชู ุชุฎููุถ 500 ุณุนุฑุฉ ุญุฑุงุฑูุฉ)',
      icon: '๐ฏ',
      color: 'info',
      macroDistribution: {
        carbs: 45,   // 45% ูู ุงูุณุนุฑุงุช
        protein: 30, // 30% ูู ุงูุณุนุฑุงุช
        fat: 25      // 25% ูู ุงูุณุนุฑุงุช
      },
      dailyMeals: {
        breakfast: [
          'ุดููุงู ูุน ุงูุญููุจ (ููุจ)',
          'ููุฒ (ุญุจุฉ ูุชูุณุทุฉ)',
          'ุฌูุฒ (10 ุญุจุงุช)',
          'ุนุณู (ููุนูุฉ ุตุบูุฑุฉ)'
        ],
        lunch: [
          'ุฃุฑุฒ ุจูู (ููุจ)',
          'ุฏุฌุงุฌ ูุดูู (150 ุฌู)',
          'ุฎุถุฑูุงุช ูุดููุฉ',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        dinner: [
          'ุณูู ูุดูู (150 ุฌู)',
          'ุจุทุงุทุง ุญููุฉ ูุดููุฉ',
          'ุจุฑูููู ูุทูู',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        snacks: [
          'ุชูุงุญ (ุญุจุฉ)',
          'ุฒุจุฏุฉ ุงูููู ุงูุณูุฏุงูู (ููุนูุฉ)',
          'ุฌุจูุฉ ููููุฉ ุงูุฏุณู (30 ุฌู)'
        ]
      },
      allowedFoods: [
        'ุฌููุน ุฃููุงุน ุงูุญุจูุจ ุงููุงููุฉ',
        'ุงูููุงูู ูุงูุฎุถุฑูุงุช',
        'ุงูุจุฑูุชููุงุช ุงูุฎุงููุฉ ูู ุงูุฏููู',
        'ุงูุฏููู ุงูุตุญูุฉ',
        'ููุชุฌุงุช ุงูุฃูุจุงู ููููุฉ ุงูุฏุณู',
        'ุงูููุณุฑุงุช ูุงูุจุฐูุฑ'
      ],
      restrictedFoods: [
        'ุงูุฃุทุนูุฉ ุงููุตูุนุฉ',
        'ุงูุณูุฑูุงุช ุงููุถุงูุฉ',
        'ุงูุฏููู ุงููุชุญููุฉ',
        'ุงููุดุฑูุจุงุช ุงููุญูุงุฉ'
      ],
      benefits: [
        'ุชุฎููุถ ุงููุฒู ุจุทุฑููุฉ ุตุญูุฉ',
        'ุชุญุณูู ุงูุตุญุฉ ุงูุนุงูุฉ',
        'ุฒูุงุฏุฉ ุงูุทุงูุฉ',
        'ุชุญุณูู ุงููุถู'
      ],
      considerations: [
        'ุดุฑุจ ูุงุก ูุงูู',
        'ููุงุฑุณุฉ ุงูุฑูุงุถุฉ ุจุงูุชุธุงู',
        'ุชุฌูุจ ุงูุฃุทุนูุฉ ุงููุตูุนุฉ',
        'ูุฑุงูุจุฉ ุงููุฒู'
      ]
    },
    weightGain: {
      id: 'weightGain',
      name: 'ูุธุงู ุฒูุงุฏุฉ ุงููุฒู',
      description: 'ูุธุงู ุบุฐุงุฆู ุนุงูู ุงูุณุนุฑุงุช ูุฒูุงุฏุฉ ุงููุฒู ุจุทุฑููุฉ ุตุญูุฉ (ูุชู ุชุฎููุถ 500 ุณุนุฑุฉ ุญุฑุงุฑูุฉ)',
      icon: '๐',
      color: 'warning',
      macroDistribution: {
        carbs: 45,   // 45% ูู ุงูุณุนุฑุงุช
        protein: 25, // 25% ูู ุงูุณุนุฑุงุช
        fat: 30      // 30% ูู ุงูุณุนุฑุงุช
      },
      dailyMeals: {
        breakfast: [
          'ุนุฌุฉ ุจุงูุฌุจู (3 ุจูุถุงุช)',
          'ุฎุจุฒ ูุงูู (2 ุดุฑูุญุฉ)',
          'ุฃูููุงุฏู (ุญุจุฉ ูุงููุฉ)',
          'ุญููุจ ูุงูู ุงูุฏุณู (ููุจ)'
        ],
        lunch: [
          'ุฃุฑุฒ ุฃุจูุถ (ููุจ ููุตู)',
          'ูุญู ุจูุฑู (200 ุฌู)',
          'ุจุทุงุทุง ููููุฉ',
          'ุณูุทุฉ ูุน ุฒูุช ุงูุฒูุชูู'
        ],
        dinner: [
          'ูุนูุฑููุฉ ุจุงููุญู (ููุจ ููุตู)',
          'ุฏุฌุงุฌ ูุดูู (200 ุฌู)',
          'ุฎุถุฑูุงุช ูุทููุฉ',
          'ุฌุจูุฉ ุจุงุฑููุฒุงู'
        ],
        snacks: [
          'ููุณุฑุงุช ูุฎุชูุทุฉ (ุญููุฉ)',
          'ููุฒ ูุน ุฒุจุฏุฉ ุงูููู ุงูุณูุฏุงูู',
          'ุญููุจ ุจุงูุดููููุงุชุฉ',
          'ุฌุจูุฉ ูุงููุฉ ุงูุฏุณู'
        ]
      },
      allowedFoods: [
        'ุงูุญุจูุจ ุงููุงููุฉ ูุงูุจูุถุงุก',
        'ุงูุจุฑูุชููุงุช ุนุงููุฉ ุงูุณุนุฑุงุช',
        'ุงูุฏููู ุงูุตุญูุฉ',
        'ุงูููุงูู ุงููุฌููุฉ',
        'ุงูููุณุฑุงุช ูุงูุจุฐูุฑ',
        'ููุชุฌุงุช ุงูุฃูุจุงู ูุงููุฉ ุงูุฏุณู'
      ],
      restrictedFoods: [
        'ุงูุฃุทุนูุฉ ููุฎูุถุฉ ุงูุณุนุฑุงุช',
        'ุงููุดุฑูุจุงุช ุงูุฏุงูุช',
        'ุงูุฎุถุฑูุงุช ุงููุฑููุฉ ููุท',
        'ุงูุฃุทุนูุฉ ููููุฉ ุงูุฏููู'
      ],
      benefits: [
        'ุฒูุงุฏุฉ ุงููุฒู ุงูุตุญูุฉ',
        'ุจูุงุก ุงูุนุถูุงุช',
        'ุชุญุณูู ุงูููุฉ ุงูุจุฏููุฉ',
        'ุฒูุงุฏุฉ ุงูุทุงูุฉ'
      ],
      considerations: [
        'ูุญุชุงุฌ ุชูุงูู ูุฌุจุงุช ูุชูุฑุฑุฉ',
        'ูุฑุงูุจุฉ ุฒูุงุฏุฉ ุงููุฒู',
        'ููุงุฑุณุฉ ุงูุฑูุงุถุฉ ูููุฉ',
        'ุชุฌูุจ ุงูุฏููู ุบูุฑ ุงูุตุญูุฉ'
      ]
    },
    pregnancy: {
      id: 'pregnancy',
      name: 'ูุธุงู ุงูุญุงูู',
      description: 'ูุธุงู ุบุฐุงุฆู ูุฎุตุต ููุญูุงูู ูุน ุงูุชุฑููุฒ ุนูู ุงูุนูุงุตุฑ ุงูุบุฐุงุฆูุฉ ุงููููุฉ (ูุชู ุชุฎููุถ 500 ุณุนุฑุฉ ุญุฑุงุฑูุฉ)',
      icon: '๐คฑ',
      color: 'info',
      macroDistribution: {
        carbs: 50,   // 50% ูู ุงูุณุนุฑุงุช
        protein: 20, // 20% ูู ุงูุณุนุฑุงุช
        fat: 30      // 30% ูู ุงูุณุนุฑุงุช
      },
      dailyMeals: {
        breakfast: [
          'ุดููุงู ูุน ุงูุญููุจ (ููุจ)',
          'ููุฒ (ุญุจุฉ)',
          'ุฌูุฒ (10 ุญุจุงุช)',
          'ุนุตูุฑ ุจุฑุชูุงู ุทุจูุนู'
        ],
        lunch: [
          'ุฃุฑุฒ ุจูู (ููุจ)',
          'ุณูู ุณูููู (150 ุฌู)',
          'ุฎุถุฑูุงุช ูุดููุฉ',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        dinner: [
          'ุฏุฌุงุฌ ูุดูู (150 ุฌู)',
          'ุจุทุงุทุง ุญููุฉ ูุดููุฉ',
          'ุจุฑูููู ูุทูู',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        snacks: [
          'ุชูุงุญ (ุญุจุฉ)',
          'ุฌุจูุฉ ููููุฉ ุงูุฏุณู (30 ุฌู)',
          'ุฒุจุฏุฉ ุงูููู ุงูุณูุฏุงูู (ููุนูุฉ)',
          'ุญููุจ (ููุจ)'
        ]
      },
      allowedFoods: [
        'ุงูุจุฑูุชููุงุช ุงูุฎุงููุฉ ูู ุงูุฏููู',
        'ุงูุญุจูุจ ุงููุงููุฉ',
        'ุงูููุงูู ูุงูุฎุถุฑูุงุช',
        'ููุชุฌุงุช ุงูุฃูุจุงู',
        'ุงูุฃุณูุงู ุงูุฏูููุฉ',
        'ุงูููุณุฑุงุช ูุงูุจุฐูุฑ'
      ],
      restrictedFoods: [
        'ุงูุฃุณูุงู ุนุงููุฉ ุงูุฒุฆุจู',
        'ุงููุญูู ุงูููุฆุฉ',
        'ุงูุฃุฌุจุงู ุงูุทุฑูุฉ',
        'ุงููุงูููู ุงูุฒุงุฆุฏ',
        'ุงููุญูู'
      ],
      benefits: [
        'ุฏุนู ููู ุงูุฌููู',
        'ููุน ููุฑ ุงูุฏู',
        'ุชูููู ุงูุบุซูุงู',
        'ุฏุนู ุตุญุฉ ุงูุฃู'
      ],
      considerations: [
        'ูุญุชุงุฌ ุญูุถ ุงูููููู',
        'ุงูุญุฏูุฏ ููู ุฌุฏุงู',
        'ุชุฌูุจ ุงูุฃุทุนูุฉ ุงูุฎุทูุฑุฉ',
        'ุดุฑุจ ูุงุก ูุงูู'
      ]
    },
    breastfeeding: {
      id: 'breastfeeding',
      name: 'ูุธุงู ุงููุฑุถุน',
      description: 'ูุธุงู ุบุฐุงุฆู ูุฎุตุต ูููุฑุถุนุงุช ูุน ุฒูุงุฏุฉ ุงูุณุนุฑุงุช ูุงูุนูุงุตุฑ ุงูุบุฐุงุฆูุฉ (ูุชู ุชุฎููุถ 500 ุณุนุฑุฉ ุญุฑุงุฑูุฉ)',
      icon: '๐ผ',
      color: 'info',
      macroDistribution: {
        carbs: 50,   // 50% ูู ุงูุณุนุฑุงุช
        protein: 20, // 20% ูู ุงูุณุนุฑุงุช
        fat: 30      // 30% ูู ุงูุณุนุฑุงุช
      },
      dailyMeals: {
        breakfast: [
          'ุดููุงู ูุน ุงูุญููุจ (ููุจ ููุตู)',
          'ููุฒ (ุญุจุฉ)',
          'ุฌูุฒ (15 ุญุจุฉ)',
          'ุนุณู (ููุนูุฉ ูุจูุฑุฉ)'
        ],
        lunch: [
          'ุฃุฑุฒ ุจูู (ููุจ ููุตู)',
          'ุฏุฌุงุฌ ูุดูู (200 ุฌู)',
          'ุฎุถุฑูุงุช ูุดููุฉ',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        dinner: [
          'ุณูู ูุดูู (200 ุฌู)',
          'ุจุทุงุทุง ุญููุฉ ูุดููุฉ',
          'ุจุฑูููู ูุทูู',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        snacks: [
          'ุชูุงุญ (ุญุจุฉ)',
          'ุฌุจูุฉ ููููุฉ ุงูุฏุณู (40 ุฌู)',
          'ุฒุจุฏุฉ ุงูููู ุงูุณูุฏุงูู (ููุนูุฉ ูุจูุฑุฉ)',
          'ุญููุจ (ููุจ ููุตู)'
        ]
      },
      allowedFoods: [
        'ุงูุจุฑูุชููุงุช ุนุงููุฉ ุงูุฌูุฏุฉ',
        'ุงูุญุจูุจ ุงููุงููุฉ',
        'ุงูููุงูู ูุงูุฎุถุฑูุงุช',
        'ููุชุฌุงุช ุงูุฃูุจุงู',
        'ุงูุฃุณูุงู ุงูุฏูููุฉ',
        'ุงูููุณุฑุงุช ูุงูุจุฐูุฑ'
      ],
      restrictedFoods: [
        'ุงููุงูููู ุงูุฒุงุฆุฏ',
        'ุงูุฃุณูุงู ุนุงููุฉ ุงูุฒุฆุจู',
        'ุงูุฃุทุนูุฉ ุงูุญุงุฑุฉ ุฌุฏุงู',
        'ุงููุญูู'
      ],
      benefits: [
        'ุฏุนู ุฅูุชุงุฌ ุงูุญููุจ',
        'ุชุบุฐูุฉ ุงูุทูู',
        'ุงุณุชุนุงุฏุฉ ุตุญุฉ ุงูุฃู',
        'ุฒูุงุฏุฉ ุงูุทุงูุฉ'
      ],
      considerations: [
        'ุฒูุงุฏุฉ ุงูุณุนุฑุงุช 500-600 ููููุงู',
        'ุดุฑุจ ูุงุก ูุงูู',
        'ุชุฌูุจ ุงูุฃุทุนูุฉ ุงููุณุจุจุฉ ููุญุณุงุณูุฉ',
        'ูุฑุงูุจุฉ ูุฒู ุงูุทูู'
      ]
    },
    diabetes: {
      id: 'diabetes',
      name: 'ูุธุงู ุงูุณูุฑู',
      description: 'ูุธุงู ุบุฐุงุฆู ูุฎุตุต ููุฑุถู ุงูุณูุฑู ูุน ุงูุชุญูู ูู ุงููุฑุจูููุฏุฑุงุช (ูุชู ุชุฎููุถ 500 ุณุนุฑุฉ ุญุฑุงุฑูุฉ)',
      icon: '๐ฉบ',
      color: 'danger',
      macroDistribution: {
        carbs: 40,   // 40% ูู ุงูุณุนุฑุงุช
        protein: 30, // 30% ูู ุงูุณุนุฑุงุช
        fat: 30      // 30% ูู ุงูุณุนุฑุงุช
      },
      dailyMeals: {
        breakfast: [
          'ุดููุงู ูุน ุงูุญููุจ ูููู ุงูุฏุณู',
          'ุชูุช (ูุตู ููุจ)',
          'ุฌูุฒ (10 ุญุจุงุช)',
          'ูููุฉ ุจุฏูู ุณูุฑ'
        ],
        lunch: [
          'ุฃุฑุฒ ุจูู (ูุตู ููุจ)',
          'ุฏุฌุงุฌ ูุดูู (150 ุฌู)',
          'ุฎุถุฑูุงุช ูุดููุฉ',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        dinner: [
          'ุณูู ูุดูู (150 ุฌู)',
          'ุฎุถุฑูุงุช ูุทููุฉ',
          'ุณูุทุฉ ุฎุถุฑุงุก',
          'ุฒูุช ุงูุฒูุชูู'
        ],
        snacks: [
          'ุชูุงุญ (ุญุจุฉ ุตุบูุฑุฉ)',
          'ุฌุจูุฉ ููููุฉ ุงูุฏุณู (30 ุฌู)',
          'ููุณุฑุงุช (ุญููุฉ ุตุบูุฑุฉ)'
        ]
      },
      allowedFoods: [
        'ุงูุฎุถุฑูุงุช ุบูุฑ ุงููุดููุฉ',
        'ุงูุจุฑูุชููุงุช ุงูุฎุงููุฉ ูู ุงูุฏููู',
        'ุงูุญุจูุจ ุงููุงููุฉ',
        'ุงูููุงูู ููููุฉ ุงูุณูุฑ',
        'ุงูุฏููู ุงูุตุญูุฉ',
        'ููุชุฌุงุช ุงูุฃูุจุงู ููููุฉ ุงูุฏุณู'
      ],
      restrictedFoods: [
        'ุงูุณูุฑูุงุช ุงููุถุงูุฉ',
        'ุงูุญุจูุจ ุงูููุฑุฑุฉ',
        'ุงูููุงูู ุนุงููุฉ ุงูุณูุฑ',
        'ุงููุดุฑูุจุงุช ุงููุญูุงุฉ',
        'ุงูุฃุทุนูุฉ ุงููุตูุนุฉ'
      ],
      benefits: [
        'ุชุญูู ูู ุณูุฑ ุงูุฏู',
        'ุชูููู ููุงููุฉ ุงูุฃูุณูููู',
        'ููุฏุงู ุงููุฒู',
        'ุชุญุณูู ุตุญุฉ ุงูููุจ'
      ],
      considerations: [
        'ูุฑุงูุจุฉ ุณูุฑ ุงูุฏู',
        'ุชูุฒูุน ุงููุฑุจูููุฏุฑุงุช',
        'ุชุฌูุจ ุงูุณูุฑูุงุช ุงูุจุณูุทุฉ',
        'ููุงุฑุณุฉ ุงูุฑูุงุถุฉ ูููุฉ'
      ]
    },
    weightMaintenance: {
      id: 'weightMaintenance',
      name: 'ูุธุงู ุชุซุจูุช ุงููุฒู',
      description: 'ูุธุงู ุบุฐุงุฆู ููุญูุงุธ ุนูู ุงููุฒู ุงูุญุงูู ูุน ุงูุชูุงุฒู ุงูุบุฐุงุฆู (ูุชู ุชุฎููุถ 500 ุณุนุฑุฉ ุญุฑุงุฑูุฉ)',
      icon: 'โ๏ธ',
      color: 'secondary',
      macroDistribution: {
        carbs: 45,   // 45% ูู ุงูุณุนุฑุงุช
        protein: 25, // 25% ูู ุงูุณุนุฑุงุช
        fat: 30      // 30% ูู ุงูุณุนุฑุงุช
      },
      dailyMeals: {
        breakfast: [
          'ุดููุงู ูุน ุงูุญููุจ (ููุจ)',
          'ููุฒ (ุญุจุฉ ูุชูุณุทุฉ)',
          'ุฌูุฒ (10 ุญุจุงุช)',
          'ุนุณู (ููุนูุฉ ุตุบูุฑุฉ)'
        ],
        lunch: [
          'ุฃุฑุฒ ุจูู (ููุจ)',
          'ุฏุฌุงุฌ ูุดูู (150 ุฌู)',
          'ุฎุถุฑูุงุช ูุดููุฉ',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        dinner: [
          'ุณูู ูุดูู (150 ุฌู)',
          'ุจุทุงุทุง ุญููุฉ ูุดููุฉ',
          'ุจุฑูููู ูุทูู',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        snacks: [
          'ุชูุงุญ (ุญุจุฉ)',
          'ุฌุจูุฉ ููููุฉ ุงูุฏุณู (30 ุฌู)',
          'ุฒุจุฏุฉ ุงูููู ุงูุณูุฏุงูู (ููุนูุฉ)'
        ]
      },
      allowedFoods: [
        'ุฌููุน ุฃููุงุน ุงูุญุจูุจ ุงููุงููุฉ',
        'ุงูููุงูู ูุงูุฎุถุฑูุงุช',
        'ุงูุจุฑูุชููุงุช ุงูุฎุงููุฉ ูู ุงูุฏููู',
        'ุงูุฏููู ุงูุตุญูุฉ',
        'ููุชุฌุงุช ุงูุฃูุจุงู ููููุฉ ุงูุฏุณู',
        'ุงูููุณุฑุงุช ูุงูุจุฐูุฑ'
      ],
      restrictedFoods: [
        'ุงูุฃุทุนูุฉ ุนุงููุฉ ุงูุณุนุฑุงุช',
        'ุงูุณูุฑูุงุช ุงููุถุงูุฉ',
        'ุงูุฏููู ุงููุชุญููุฉ',
        'ุงููุดุฑูุจุงุช ุงููุญูุงุฉ'
      ],
      benefits: [
        'ุงูุญูุงุธ ุนูู ุงููุฒู',
        'ุชูุงุฒู ุบุฐุงุฆู',
        'ุตุญุฉ ุนุงูุฉ ุฌูุฏุฉ',
        'ุทุงูุฉ ูุณุชูุฑุฉ'
      ],
      considerations: [
        'ูุฑุงูุจุฉ ุงููุฒู ุฃุณุจูุนูุงู',
        'ุชุนุฏูู ุงูุณุนุฑุงุช ุญุณุจ ุงููุดุงุท',
        'ููุงุฑุณุฉ ุงูุฑูุงุถุฉ',
        'ุชุฌูุจ ุงูุฅูุฑุงุท ูู ุงูุทุนุงู'
      ]
    },
    high_protein: {
      id: 'high_protein',
      name: 'ุงููุธุงู ุงูุบุฐุงุฆู ุนุงูู ุงูุจุฑูุชูู',
      description: 'ูุธุงู ุบุฐุงุฆู ูุฑูุฒ ุนูู ุงูุจุฑูุชูู ูุจูุงุก ุงูุนุถูุงุช ูููุฏุงู ุงูุฏููู (ูุชู ุชุฎููุถ 500 ุณุนุฑุฉ ุญุฑุงุฑูุฉ)',
      icon: '๐ช',
      color: 'primary',
      macroDistribution: {
        carbs: 30,   // 30% ูู ุงูุณุนุฑุงุช
        protein: 40, // 40% ูู ุงูุณุนุฑุงุช
        fat: 30      // 30% ูู ุงูุณุนุฑุงุช
      },
      dailyMeals: {
        breakfast: [
          'ุจูุถ ูุณููู (3 ุจูุถุงุช)',
          'ุตุฏุฑ ุฏุฌุงุฌ ูุดูู (100 ุฌู)',
          'ุฎุจุฒ ุฃุณูุฑ (ุดุฑูุญุฉ ูุงุญุฏุฉ)',
          'ุฌุจู ูููู ุงูุฏุณู (30 ุฌู)'
        ],
        lunch: [
          'ุณูู ุณูููู ูุดูู (150 ุฌู)',
          'ุฃุฑุฒ ุจูู (100 ุฌู)',
          'ุจุฑูููู ูุทูู',
          'ุณูุทุฉ ุฎุถุฑุงุก'
        ],
        dinner: [
          'ูุญู ุจูุฑู ูุดูู (120 ุฌู)',
          'ุจุทุงุทุง ุญููุฉ ูุดููุฉ',
          'ุณุจุงูุฎ ูุทูู',
          'ุฌุจู ูููู ุงูุฏุณู (20 ุฌู)'
        ],
        snacks: [
          'ุฒุจุงุฏู ูููุงูู (150 ุฌู)',
          'ููุฒ (15 ุญุจุฉ)',
          'ุจุฑูุชูู ุดูู',
          'ุฌุจู ูููู ุงูุฏุณู (30 ุฌู)'
        ]
      },
      allowedFoods: [
        'ุงููุญูู ุงูุฎุงููุฉ ูู ุงูุฏููู',
        'ุงูุฏูุงุฌู ูุงูุฃุณูุงู',
        'ุงูุจูุถ ูููุชุฌุงุช ุงูุฃูุจุงู',
        'ุงูุจููููุงุช ูุงูููุณุฑุงุช',
        'ุงูุฎุถุฑูุงุช ุงููุฑููุฉ',
        'ุงูุญุจูุจ ุงููุงููุฉ'
      ],
      restrictedFoods: [
        'ุงูุฃุทุนูุฉ ุนุงููุฉ ุงููุฑุจูููุฏุฑุงุช',
        'ุงูุณูุฑูุงุช ุงููุถุงูุฉ',
        'ุงูุฏููู ุงููุดุจุนุฉ',
        'ุงููุดุฑูุจุงุช ุงููุญูุงุฉ'
      ],
      benefits: [
        'ุจูุงุก ุงูุนุถูุงุช',
        'ููุฏุงู ุงูุฏููู',
        'ุชุญุณูู ุงูุชูุซูู ุงูุบุฐุงุฆู',
        'ุงูุดุนูุฑ ุจุงูุดุจุน'
      ],
      considerations: [
        'ุดุฑุจ ุงููุงุก ุจูุซุฑุฉ',
        'ุชูุฒูุน ุงูุจุฑูุชูู ุนูู ุงููุฌุจุงุช',
        'ููุงุฑุณุฉ ุชูุงุฑูู ุงูููุฉ',
        'ูุฑุงูุจุฉ ูุธุงุฆู ุงูููู'
      ]
    }
  }

  // ุญุณุงุจ ุงูุชูุฒูุน ุงููุฎุตุต ููุนูุงุตุฑ ุงูุบุฐุงุฆูุฉ
  const calculateCustomizedMacros = (dietPlan) => {
    if (!nutritionData || !dietPlan) return null

    // ุงุณุชุฎุฏุงู ุงูุณุนุฑุงุช ุงููุฎุชุงุฑุฉ ุฅุฐุง ูุงูุช ูุชููุฑุฉุ ูุฅูุง ุงุณุชุฎุฏุงู ุงูุณุนุฑุงุช ุงูุฃุตููุฉ
    let baseCalories = selectedCalories || nutritionData.targetCalories
    const { macroDistribution } = dietPlan

r    // ุทุฑุญ 500 ุณุนุฑุฉ ุญุฑุงุฑูุฉ ูุฌููุน ุงูุฃูุธูุฉ ุงูุบุฐุงุฆูุฉ
    baseCalories = Math.max(baseCalories - 500, 1200) // ุงูุญุฏ ุงูุฃุฏูู 1200 ุณุนุฑุฉ

    const carbs = Math.round((baseCalories * macroDistribution.carbs / 100) / 4)
    const protein = Math.round((baseCalories * macroDistribution.protein / 100) / 4)
    const fat = Math.round((baseCalories * macroDistribution.fat / 100) / 9)

    return {
      carbs,
      protein,
      fat,
      calories: baseCalories,
      originalCalories: nutritionData.targetCalories, // ุญูุธ ุงูุณุนุฑุงุช ุงูุฃุตููุฉ
      calorieReduction: 500 // ููุฏุงุฑ ุงูุชุฎููุถ ูุฌููุน ุงูุฃูุธูุฉ
    }
  }

  // ุฅุนุงุฏุฉ ุชุนููู ุงูุณุนุฑุงุช ุงููุฎุชุงุฑุฉ ุนูุฏ ุชุบููุฑ ุจูุงูุงุช ุงููุฑูุถ
  useEffect(() => {
    setSelectedCalories(null)
    setSelectedDietPlan(null)
    setCustomizedPlan(null)
  }, [nutritionData])

  // ุชุญุฏูุซ ุงูุฎุทุฉ ุงููุฎุตุตุฉ ุนูุฏ ุชุบููุฑ ุงููุธุงู
  useEffect(() => {
    if (selectedDietPlan) {
      const customized = calculateCustomizedMacros(dietPlans[selectedDietPlan])
      setCustomizedPlan(customized)
      
      if (onDietPlanSelected) {
        onDietPlanSelected({
          plan: dietPlans[selectedDietPlan],
          customizedMacros: customized
        })
      }
    }
  }, [selectedDietPlan, nutritionData, selectedCalories])

  const handleDietPlanSelect = (planId) => {
    setIsLoading(true)
    setSelectedDietPlan(planId)
    setShowFullDetails(false) // ุฅุนุงุฏุฉ ุชุนููู ุนุฑุถ ุงูุชูุงุตูู
    
    // ุญูุธ ุงูุณุนุฑุงุช ุงููุฎุชุงุฑุฉ ูููุธุงู ุงูุฌุฏูุฏ
    if (nutritionData) {
      let newCalories = nutritionData.targetCalories
      
      // ุชุทุจูู ุงูุชุฎููุถ ูุฌููุน ุงูุฃูุธูุฉ ุงูุบุฐุงุฆูุฉ
      newCalories = Math.max(newCalories - 500, 1200)
      
      setSelectedCalories(newCalories)
    }
    
    // ูุญุงูุงุฉ ุชุญููู ุณุฑูุน ูุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู
    setTimeout(() => {
      setIsLoading(false)
    }, 300)
  }

  return (
    <div className="card">
      <div className="card-header">
        <h5 className="mb-0">
          <i className="fas fa-utensils text-primary me-2"></i>
          ุงูุฃูุธูุฉ ุงูุบุฐุงุฆูุฉ ุงููุชูุงููุฉ
        </h5>
        <p className="text-muted mb-0">ุงุฎุชุฑ ุงููุธุงู ุงูุบุฐุงุฆู ุงูููุงุณุจ ูููุฑูุถ</p>
      </div>
      <div className="card-body">
        {/* ุชุญุฐูุฑ ุฅุฐุง ูู ุชูู ุจูุงูุงุช ุงูุชุบุฐูุฉ ูุชููุฑุฉ */}
        {!nutritionData && (
          <div className="alert alert-warning mb-4">
            <i className="fas fa-exclamation-triangle me-2"></i>
            <strong>ุชุญุฐูุฑ:</strong> ูู ูุชู ุญุณุงุจ ุจูุงูุงุช ุงูุชุบุฐูุฉ ูููุฑูุถ ุจุนุฏ. 
            ูุฑุฌู ุงูุชุฃูุฏ ูู ุฅุฏุฎุงู ุงููุฒู ูุงูุทูู ูุงููุฏู ููุณุชูู ุงููุดุงุท ูู ุงูููู ุงูุดุฎุตู.
          </div>
        )}

        {/* ุนุฑุถ ุงูุฃูุธูุฉ ุงูุบุฐุงุฆูุฉ */}
        <div className="row mb-4">
          {Object.values(dietPlans).map((plan) => (
            <div key={plan.id} className="col-md-6 col-lg-4 mb-3">
              <div 
                className={`card h-100 cursor-pointer border-${selectedDietPlan === plan.id ? plan.color : 'light'}`}
                onClick={() => handleDietPlanSelect(plan.id)}
                style={{ 
                  cursor: 'pointer',
                  borderWidth: selectedDietPlan === plan.id ? '2px' : '1px'
                }}
              >
                <div className="card-body text-center">
                  <div className="fs-1 mb-2">{plan.icon}</div>
                  <h6 className={`text-${plan.color} mb-2`}>{plan.name}</h6>
                  <p className="text-muted small mb-3">{plan.description}</p>
                  <div className="d-flex justify-content-center">
                    <span className={`badge bg-${plan.color} bg-opacity-10 text-${plan.color}`}>
                      {plan.macroDistribution.carbs}% ูุฑุจูููุฏุฑุงุช
                    </span>
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>

        {/* ูุคุดุฑ ุงูุชุญููู */}
        {isLoading && (
          <div className="text-center py-4">
            <div className="spinner-border text-primary" role="status">
              <span className="visually-hidden">ุฌุงุฑู ุงูุชุญููู...</span>
            </div>
            <p className="text-muted mt-2">ุฌุงุฑู ุชุญููู ุชูุงุตูู ุงููุธุงู ุงูุบุฐุงุฆู...</p>
          </div>
        )}

        {/* ุนุฑุถ ุชูุงุตูู ุงููุธุงู ุงููุฎุชุงุฑ */}
        {selectedDietPlan && customizedPlan && !isLoading && (
          <div className="border rounded p-4 bg-light">
            <div className="row">
              <div className="col-md-6">
                <div className="d-flex justify-content-between align-items-center mb-3">
                  <h6 className="text-primary mb-0">
                    {dietPlans[selectedDietPlan].icon} {dietPlans[selectedDietPlan].name}
                  </h6>
                  <button 
                    className="btn btn-sm btn-outline-primary"
                    onClick={() => setShowFullDetails(!showFullDetails)}
                  >
                    {showFullDetails ? 'ุฅุฎูุงุก ุงูุชูุงุตูู' : 'ุนุฑุถ ุงูุชูุงุตูู ุงููุงููุฉ'}
                  </button>
                </div>
                
                {/* ุงูุชูุฒูุน ุงููุฎุตุต ููุนูุงุตุฑ ุงูุบุฐุงุฆูุฉ */}
                <div className="mb-3">
                  <h6 className="text-success">ุงูุชูุฒูุน ุงููุฎุตุต ููุนูุงุตุฑ ุงูุบุฐุงุฆูุฉ:</h6>
                  <div className="row">
                    <div className="col-4">
                      <div className="text-center p-2 bg-primary bg-opacity-10 rounded">
                        <div className="fw-bold text-primary">{customizedPlan.carbs} ุฌู</div>
                        <small className="text-muted">ูุฑุจูููุฏุฑุงุช</small>
                      </div>
                    </div>
                    <div className="col-4">
                      <div className="text-center p-2 bg-warning bg-opacity-10 rounded">
                        <div className="fw-bold text-warning">{customizedPlan.protein} ุฌู</div>
                        <small className="text-muted">ุจุฑูุชูู</small>
                      </div>
                    </div>
                    <div className="col-4">
                      <div className="text-center p-2 bg-danger bg-opacity-10 rounded">
                        <div className="fw-bold text-danger">{customizedPlan.fat} ุฌู</div>
                        <small className="text-muted">ุฏููู</small>
                      </div>
                    </div>
                  </div>
                  <div className="text-center mt-2">
                    <span className="badge bg-success">
                      ุฅุฌูุงูู ุงูุณุนุฑุงุช: {customizedPlan.calories} ุณุนุฑุฉ
                    </span>
                    {customizedPlan.calorieReduction > 0 && (
                      <div className="mt-2">
                        <small className="text-success">
                          <i className="fas fa-arrow-down me-1"></i>
                          ุชู ุชุฎููุถ {customizedPlan.calorieReduction} ุณุนุฑุฉ ูู ุงูุณุนุฑุงุช ุงูุฃุตููุฉ ({customizedPlan.originalCalories} ุณุนุฑุฉ)
                        </small>
                      </div>
                    )}
                  </div>
                </div>

                {/* ุงููุฌุจุงุช ุงูููููุฉ - ุนุฑุถ ููุท ุนูุฏ ุงูุญุงุฌุฉ */}
                {showFullDetails && (
                  <div className="mb-3">
                    <h6 className="text-info">ุงููุฌุจุงุช ุงูููููุฉ ุงูููุชุฑุญุฉ:</h6>
                    <div className="row">
                      <div className="col-6">
                        <div className="mb-2">
                          <strong className="text-primary">ุงูุฅูุทุงุฑ:</strong>
                          <ul className="small mb-0">
                            {dietPlans[selectedDietPlan].dailyMeals.breakfast.map((item, index) => (
                              <li key={index}>{item}</li>
                            ))}
                          </ul>
                        </div>
                        <div className="mb-2">
                          <strong className="text-success">ุงูุบุฏุงุก:</strong>
                          <ul className="small mb-0">
                            {dietPlans[selectedDietPlan].dailyMeals.lunch.map((item, index) => (
                              <li key={index}>{item}</li>
                            ))}
                          </ul>
                        </div>
                      </div>
                      <div className="col-6">
                        <div className="mb-2">
                          <strong className="text-warning">ุงูุนุดุงุก:</strong>
                          <ul className="small mb-0">
                            {dietPlans[selectedDietPlan].dailyMeals.dinner.map((item, index) => (
                              <li key={index}>{item}</li>
                            ))}
                          </ul>
                        </div>
                        <div className="mb-2">
                          <strong className="text-info">ุงููุฌุจุงุช ุงูุฎูููุฉ:</strong>
                          <ul className="small mb-0">
                            {dietPlans[selectedDietPlan].dailyMeals.snacks.map((item, index) => (
                              <li key={index}>{item}</li>
                            ))}
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </div>

              <div className="col-md-6">
                {/* ุงูุฃุทุนูุฉ ุงููุณููุญุฉ ูุงูููููุนุฉ - ุนุฑุถ ููุท ุนูุฏ ุงูุญุงุฌุฉ */}
                {showFullDetails && (
                  <div className="row">
                    <div className="col-6">
                      <h6 className="text-success">ุงูุฃุทุนูุฉ ุงููุณููุญุฉ:</h6>
                      <ul className="small">
                        {dietPlans[selectedDietPlan].allowedFoods.map((food, index) => (
                          <li key={index} className="text-success">{food}</li>
                        ))}
                      </ul>
                    </div>
                    <div className="col-6">
                      <h6 className="text-danger">ุงูุฃุทุนูุฉ ุงูููููุนุฉ:</h6>
                      <ul className="small">
                        {dietPlans[selectedDietPlan].restrictedFoods.map((food, index) => (
                          <li key={index} className="text-danger">{food}</li>
                        ))}
                      </ul>
                    </div>
                  </div>
                )}

                {/* ุงูููุงุฆุฏ ูุงูุงุนุชุจุงุฑุงุช - ุนุฑุถ ููุท ุนูุฏ ุงูุญุงุฌุฉ */}
                {showFullDetails && (
                  <div className="row mt-3">
                    <div className="col-6">
                      <h6 className="text-primary">ุงูููุงุฆุฏ:</h6>
                      <ul className="small">
                        {dietPlans[selectedDietPlan].benefits.map((benefit, index) => (
                          <li key={index} className="text-primary">{benefit}</li>
                        ))}
                      </ul>
                    </div>
                    <div className="col-6">
                      <h6 className="text-warning">ุงุนุชุจุงุฑุงุช ูููุฉ:</h6>
                      <ul className="small">
                        {dietPlans[selectedDietPlan].considerations.map((consideration, index) => (
                          <li key={index} className="text-warning">{consideration}</li>
                        ))}
                      </ul>
                    </div>
                  </div>
                )}
              </div>
            </div>
          </div>
        )}
      </div>
    </div>
  )
}

export default DietPlansSystem
